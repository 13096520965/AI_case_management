# 测试"查看详情"按钮 - 快速指南

## ✅ 修复已完成

"查看详情"按钮不显示的问题已修复。

## 🔧 修复内容

1. **组件改进**：使用 `withDefaults` 和 `computed` 确保按钮默认显示
2. **父组件更新**：明确传递 `show-detail-button` 属性
3. **热更新完成**：Vite 已自动更新前端代码

## 🧪 测试步骤

### 1. 刷新浏览器

由于 Vite 已经进行了热更新，你可以：

**选项 A：软刷新**（推荐先尝试）
- 直接刷新页面：`F5` 或 `Ctrl+R` (Mac: `Cmd+R`)

**选项 B：硬刷新**（如果软刷新后仍有问题）
- Windows/Linux: `Ctrl + Shift + R`
- Mac: `Cmd + Shift + R`

### 2. 进入案件编辑页面

1. 在浏览器中打开案件管理系统
2. 进入"案件列表"页面
3. 选择任意一个案件
4. 点击"编辑"按钮

### 3. 查找标的处理详情卡片

1. 在编辑页面向下滚动
2. 找到"标的处理详情"卡片（带有 💰 图标）
3. 卡片应该在"诉讼主体"卡片之前

### 4. 验证按钮

**应该看到**：
```
┌─────────────────────────────────────────────────────────┐
│ 💰 标的处理详情                    [查看详情]           │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  标的总额        已收回         剩余          回收率    │
│  ¥0.00         ¥0.00         ¥0.00          0.00%      │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

**按钮特征**：
- ✅ 位置：卡片标题右侧
- ✅ 颜色：蓝色（Primary）
- ✅ 大小：小号按钮
- ✅ 文字："查看详情"

### 5. 测试按钮功能

1. **点击"查看详情"按钮**
   - 应该弹出一个对话框
   - 对话框标题："标的处理详情"
   - 对话框宽度：1200px

2. **查看"基本信息"标签页**
   - 标的总额输入框
   - 违约金输入框
   - 诉讼成本输入框
   - 成本承担方输入框
   - 备注文本框
   - "保存基本信息"按钮

3. **查看"汇款记录"标签页**
   - "添加汇款记录"按钮
   - 汇款记录表格（可能为空）
   - 表格列：汇款日期、金额、付款方、收款方、支付方式、状态、备注、操作

4. **测试编辑功能**
   - 在"基本信息"中输入一些数据
   - 点击"保存基本信息"
   - 应该显示"基本信息保存成功"

5. **测试添加汇款记录**
   - 切换到"汇款记录"标签页
   - 点击"添加汇款记录"
   - 填写表单
   - 点击"保存"
   - 应该显示"汇款记录添加成功"

## 🐛 如果按钮仍然不显示

### 检查清单

1. **确认在编辑模式**
   - ❌ 新建案件页面不会显示此卡片
   - ✅ 编辑现有案件才会显示

2. **检查浏览器控制台**
   - 按 `F12` 打开开发者工具
   - 切换到"Console"标签
   - 查看是否有红色错误信息

3. **检查网络请求**
   - 在开发者工具中切换到"Network"标签
   - 刷新页面
   - 查找 `/api/cases/:id/target-amount` 请求
   - 检查响应状态是否为 200

4. **检查组件渲染**
   - 在开发者工具中切换到"Elements"标签
   - 搜索 "target-amount-detail"
   - 确认组件已渲染
   - 检查按钮元素是否存在

### 调试命令

在浏览器控制台执行：

```javascript
// 检查组件是否存在
document.querySelector('.target-amount-detail')

// 检查按钮是否存在
document.querySelector('.target-amount-detail .el-button')

// 检查卡片标题
document.querySelector('.target-amount-detail .card-title')
```

### 常见问题

**问题 1：整个卡片都不显示**
- **原因**：可能不在编辑模式
- **解决**：确保从案件列表点击"编辑"进入

**问题 2：卡片显示但没有按钮**
- **原因**：可能是缓存问题
- **解决**：硬刷新浏览器（Ctrl+Shift+R）

**问题 3：按钮显示但点击无反应**
- **原因**：可能有 JavaScript 错误
- **解决**：检查浏览器控制台错误信息

**问题 4：对话框打开但内容为空**
- **原因**：API 请求失败
- **解决**：检查后端服务器是否运行，查看网络请求

## 📊 预期数据

### 首次访问

如果是第一次访问某个案件的标的处理详情：
- 标的总额：¥0.00（或案件的 target_amount）
- 已收回：¥0.00
- 剩余：¥0.00
- 回收率：0.00%
- 汇款记录：空列表

### 添加数据后

编辑基本信息并添加汇款记录后：
- 标的总额：显示你输入的金额
- 已收回：只统计"已确认"状态的汇款
- 剩余：标的总额 - 已收回
- 回收率：(已收回 / 标的总额) × 100%

## ✅ 成功标志

如果看到以下内容，说明功能正常：

1. ✅ "查看详情"按钮显示在卡片标题右侧
2. ✅ 点击按钮打开详情对话框
3. ✅ 可以编辑基本信息并保存
4. ✅ 可以添加、编辑、删除汇款记录
5. ✅ 统计数据实时更新

## 🎉 测试完成

如果所有功能都正常工作，恭喜！标的处理详情功能已成功部署。

如果遇到任何问题，请：
1. 查看浏览器控制台错误
2. 检查后端服务器日志
3. 参考 `TARGET-AMOUNT-BUTTON-FIX.md` 文档
4. 运行后端测试：`node test-target-amount-api.js`
