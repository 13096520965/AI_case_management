# 前端页面联调测试指南

## ✅ API已确认正常

根据你的反馈，`/api/notifications` 接口已经正常返回数据。现在进行前端页面联调。

## 🎯 测试步骤

### 步骤1: 访问应用

打开浏览器访问：**http://localhost:5173**

### 步骤2: 登录系统

如果未登录，先登录系统：
- 访问: http://localhost:5173/login
- 使用测试账号登录

### 步骤3: 测试提醒悬浮层

1. **查看红色角标**
   - 位置：页面右上角铃铛图标
   - 预期：显示红色角标 `(20)`

2. **点击铃铛图标**
   - 预期：弹出提醒悬浮层
   - 内容：显示最近10条提醒

3. **查看未读提醒**
   - 预期：未读提醒前面有红点 `●`
   - 数量：应该有多条未读提醒

4. **点击单条提醒**
   - 预期：跳转到提醒中心页面
   - 效果：该提醒标记为已读

5. **点击"查看更多"**
   - 预期：跳转到提醒列表页面

### 步骤4: 测试提醒列表页面

访问：**http://localhost:5173/notifications**

#### 4.1 检查数据显示
- [ ] 页面显示31条提醒数据
- [ ] 未读徽章显示 `(20)`
- [ ] 提醒卡片正常渲染
- [ ] 图标和颜色正确显示

#### 4.2 测试搜索功能
```
1. 在搜索框输入"张三"
2. 点击【搜索】按钮
3. 预期：只显示包含"张三"的提醒

4. 点击【重置】按钮
5. 预期：显示所有提醒
```

#### 4.3 测试筛选功能
```
状态筛选：
- 选择"未读" → 显示20条
- 选择"已读" → 显示11条
- 选择"全部" → 显示31条

类型筛选：
- 选择"节点到期" → 显示7条
- 选择"节点超期" → 显示4条
- 选择"费用支付" → 显示8条
- 选择"协作任务" → 显示7条
- 选择"系统通知" → 显示5条
```

#### 4.4 测试操作功能
```
1. 点击【一键标为已读】
   - 预期：弹出确认对话框
   - 确认后：所有未读变为已读
   - 徽章数量变为 (0)

2. 点击【刷新】按钮
   - 预期：重新加载数据
   - 显示loading状态

3. 点击单条【标记已读】
   - 预期：该提醒变为已读
   - 背景色从蓝色变为白色

4. 点击【删除】按钮
   - 预期：弹出确认对话框
   - 确认后：该提醒被删除
```

## 🔍 调试检查

### 打开浏览器开发者工具 (F12)

#### 1. Network标签
```
查找请求：/api/notifications
状态码：200 OK
响应格式：
{
  "success": true,
  "data": [
    {
      "id": 81,
      "relatedId": 6,
      "relatedType": "process_node",
      "taskType": "deadline",
      "scheduledTime": "2025-11-28T06:51:18.817Z",
      "content": "案件\"孙七房产纠纷案\"流程节点\"调解协商\"将在一周后到期",
      "status": "unread",
      "createdAt": "2025-11-15T06:34:31.789Z"
    },
    ...
  ]
}
```

#### 2. Console标签
```javascript
// 执行以下命令检查数据
const store = window.__PINIA__.state.value.notification
console.log('提醒总数:', store.notifications.length)
console.log('未读数量:', store.unreadCount)
console.log('第一条提醒:', store.notifications[0])
```

预期输出：
```
提醒总数: 31
未读数量: 20
第一条提醒: {
  id: 81,
  relatedId: 6,
  relatedType: "process_node",
  taskType: "deadline",
  scheduledTime: "2025-11-28T06:51:18.817Z",
  content: "案件\"孙七房产纠纷案\"流程节点\"调解协商\"将在一周后到期",
  status: "unread",
  createdAt: "2025-11-15T06:34:31.789Z"
}
```

#### 3. Vue DevTools
```
1. 打开Vue DevTools
2. 切换到Pinia标签
3. 查看notification store
4. 检查notifications数组
```

## 📊 预期效果

### 提醒悬浮层
```
┌─────────────────────────────┐
│ 提醒通知         20条未读    │
├─────────────────────────────┤
│ ● 🔔 案件"孙七房产纠纷案"   │
│      流程节点"调解协商"      │
│      将在一周后到期          │
│      7天后                   │
├─────────────────────────────┤
│ ● 🔔 案件"王五劳动争议案"   │
│      流程节点"提交答辩状"    │
│      将在3天后到期           │
│      3天后                   │
├─────────────────────────────┤
│   💰 案件"孙七交通案"       │
│      保全费即将到期          │
│      金额：5,000元           │
│      3天后                   │
├─────────────────────────────┤
│         查看更多 →           │
└─────────────────────────────┘
```

### 提醒列表页面
```
┌─────────────────────────────────────────────────────┐
│ 提醒中心                                              │
├─────────────────────────────────────────────────────┤
│ [状态筛选▼] [类型筛选▼] [🔍 搜索提醒内容...]          │
│ [搜索] [重置]                                         │
├─────────────────────────────────────────────────────┤
│ (20)                      [一键标为已读] [刷新]       │
├─────────────────────────────────────────────────────┤
│ 🔔 [节点到期] 案件"孙七房产纠纷案"流程节点"调解协商" │
│    将在一周后到期                           7天后     │
│    关联: process_node #6            [标记已读] [删除]│
├─────────────────────────────────────────────────────┤
│ 🔔 [节点到期] 案件"王五劳动争议案"流程节点"提交答辩状"│
│    将在3天后到期，请提前准备                3天后     │
│    关联: process_node #12           [标记已读] [删除]│
├─────────────────────────────────────────────────────┤
│ 💰 [费用支付] 案件"孙七交通案"保全费即将到期，金额： │
│    5,000元，请在3天内支付                   3天后     │
│    关联: cost #8                    [标记已读] [删除]│
└─────────────────────────────────────────────────────┘
```

## ❌ 常见问题

### 问题1: 页面空白
**原因**: 未登录或token过期
**解决**: 先登录系统

### 问题2: 显示"暂无提醒"
**原因**: 数据未加载或API请求失败
**解决**: 
1. 检查Network标签的API请求
2. 查看Console是否有错误
3. 刷新页面重试

### 问题3: 红色角标不显示
**原因**: 未读数量为0或数据未加载
**解决**: 
1. 检查Store中的unreadCount
2. 确认数据库中有未读提醒
3. 刷新页面

### 问题4: 搜索/筛选无效
**原因**: 前端逻辑错误或数据格式问题
**解决**: 
1. 查看Console错误
2. 检查Vue DevTools中的filters状态
3. 确认数据格式正确（camelCase）

## 🎬 测试视频脚本

### 场景1: 查看提醒悬浮层
```
1. 打开首页
2. 鼠标移到右上角铃铛图标
3. 看到红色角标 (20)
4. 点击铃铛图标
5. 悬浮层弹出
6. 显示最近10条提醒
7. 未读提醒有红点
8. 点击一条提醒
9. 跳转到提醒中心
```

### 场景2: 搜索特定提醒
```
1. 进入提醒中心
2. 在搜索框输入"律师费"
3. 点击搜索按钮
4. 只显示包含"律师费"的提醒
5. 点击重置按钮
6. 显示所有提醒
```

### 场景3: 筛选超期提醒
```
1. 进入提醒中心
2. 点击类型筛选下拉框
3. 选择"节点超期"
4. 只显示4条超期提醒
5. 这些提醒左侧有红色边框
6. 标签显示为红色"节点超期"
```

### 场景4: 批量标记已读
```
1. 进入提醒中心
2. 看到未读徽章 (20)
3. 点击"一键标为已读"按钮
4. 弹出确认对话框
5. 点击确定
6. 所有未读变为已读
7. 徽章数量变为 (0)
8. 提醒背景色从蓝色变为白色
```

## 📸 截图检查点

请在以下位置截图验证：

1. **首页 - 提醒图标**
   - 红色角标显示 (20)

2. **提醒悬浮层**
   - 显示最近10条提醒
   - 未读提醒有红点

3. **提醒列表页面**
   - 显示31条提醒
   - 未读徽章 (20)
   - 提醒卡片正常渲染

4. **搜索结果**
   - 搜索"张三"的结果

5. **筛选结果**
   - 筛选"节点超期"的结果

6. **操作后效果**
   - 标记已读后的效果
   - 删除后的效果

## ✅ 测试完成标准

- [ ] 提醒悬浮层正常显示
- [ ] 红色角标数量正确
- [ ] 提醒列表显示31条数据
- [ ] 搜索功能正常工作
- [ ] 筛选功能正常工作
- [ ] 一键标为已读功能正常
- [ ] 单条标记已读功能正常
- [ ] 删除功能正常
- [ ] 分页功能正常
- [ ] 自动刷新功能正常

---

**准备好了吗？开始测试吧！** 🚀

如果遇到任何问题，请查看 [调试指南](./DEBUG-NOTIFICATION.md)
